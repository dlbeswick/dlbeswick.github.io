import { assert } from './assert.js';
export function range(i) {
    return Array(i).fill(undefined);
}
export function equals(lhs, rhs) {
    if (lhs.length != rhs.length)
        return false;
    for (let i = 0; i < lhs.length; ++i)
        if (lhs[i] != rhs[i])
            return false;
    return true;
}
export function insertAt(ary, idx, item) {
    assert(idx >= 0 && idx <= ary.length, "OOB insert to array", ary.length, idx);
    return ary.slice(0, idx).concat(item).concat(ary.slice(idx));
}
// Remove the first occurrance of the given element from the array
export function remove(ary, el) {
    const idx = ary.indexOf(el);
    assert(idx != -1, "OOB remove from array");
    return ary.slice(0, idx).concat(ary.slice(idx + 1));
}
export function removeIdx(ary, idx) {
    assert(idx != -1, "OOB remove from array");
    return ary.slice(0, idx).concat(ary.slice(idx + 1));
}
function sort_default(a, b) {
    return a - b;
}
export function sorted(e, sort = sort_default) {
    return Array.from(e).sort(sort);
}
export function sorted_by(ary, sort_by, sort = sort_default) {
    const result = ary.
        map((el, i) => [sort_by(el), i]).
        sort((a, b) => sort(a[0], b[0]));
    return result.map((_, i) => ary[i]);
}
export function group_by(ary, group, sort = sort_default) {
    if (ary.length == 0)
        return [];
    const result = [];
    let s = sorted_by(ary, group, sort);
    const g = group(s[0]);
    while (s.length) {
        const accum = [];
        for (const el of s) {
            const g_ = group(el);
            if (sort(g, g) == 0) {
                accum.push(el);
            }
            else {
                result.push([g, accum]);
                s = s.slice(accum.length);
            }
        }
    }
    return result;
}
export function distinct(ary, sort = sort_default) {
    if (ary.length == 0)
        return [];
    let s = sorted(ary, sort);
    const result = [s[0]];
    for (const el of s.slice(1)) {
        if (sort(el, result[result.length - 1]) != 0)
            result.push(el);
    }
    return result;
}
// Return a tuple of two arrays.
// The first array contains those elements that are classed as false by the classifier.
export function partition(ary, classify) {
    const left = [];
    const right = [];
    for (const i of ary) {
        if (classify(i))
            right.push(i);
        else
            left.push(i);
    }
    return [left, right];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJyYXkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi90cy9hcnJheS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sYUFBYSxDQUFBO0FBRXBDLE1BQU0sVUFBVSxLQUFLLENBQUMsQ0FBUztJQUM3QixPQUFPLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7QUFDakMsQ0FBQztBQUVELE1BQU0sVUFBVSxNQUFNLENBQUMsR0FBbUIsRUFBRSxHQUFtQjtJQUM3RCxJQUFJLEdBQUcsQ0FBQyxNQUFNLElBQUksR0FBRyxDQUFDLE1BQU07UUFDMUIsT0FBTyxLQUFLLENBQUE7SUFFZCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUM7UUFDakMsSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQztZQUNsQixPQUFPLEtBQUssQ0FBQTtJQUVoQixPQUFPLElBQUksQ0FBQTtBQUNiLENBQUM7QUFFRCxNQUFNLFVBQVUsUUFBUSxDQUFJLEdBQWlCLEVBQUUsR0FBVyxFQUFFLElBQU87SUFDakUsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEdBQUcsQ0FBQyxNQUFNLEVBQUUscUJBQXFCLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQTtJQUM3RSxPQUFPLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBO0FBQzlELENBQUM7QUFFRCxrRUFBa0U7QUFDbEUsTUFBTSxVQUFVLE1BQU0sQ0FBQyxHQUFtQixFQUFFLEVBQU87SUFD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R0FBaUIsRUFBRSxPQUE2QixZQUFZO0lBQ3RGLElBQUksR0FBRyxDQUFDLE1BQU0sSUFBSSxDQUFDO1FBQ2pCLE9BQU8sRUFBRSxDQUFBO0lBRVgsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQTtJQUV6QixNQUFNLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBRXJCLEtBQUssTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRTtRQUMzQixJQUFJLElBQUksQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUE7S0FDbEI7SUFFRCxPQUFPLE1BQU0sQ0FBQTtBQUNmLENBQUM7QUFFRCxnQ0FBZ0M7QUFDaEMsdUZBQXVGO0FBQ3ZGLE1BQU0sVUFBVSxTQUFTLENBQUksR0FBaUIsRUFBRSxRQUEyQjtJQUN6RSxNQUFNLElBQUksR0FBUSxFQUFFLENBQUE7SUFDcEIsTUFBTSxLQUFLLEdBQVEsRUFBRSxDQUFBO0lBRXJCLEtBQUssTUFBTSxDQUFDLElBQUksR0FBRyxFQUFFO1FBQ25CLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQztZQUNiLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7O1lBRWIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtLQUNmO0lBRUQsT0FBTyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtBQUN0QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSAnLi9hc3NlcnQuanMnXG5cbmV4cG9ydCBmdW5jdGlvbiByYW5nZShpOiBudW1iZXIpIHtcbiAgcmV0dXJuIEFycmF5KGkpLmZpbGwodW5kZWZpbmVkKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZXF1YWxzKGxoczogcmVhZG9ubHkgYW55W10sIHJoczogcmVhZG9ubHkgYW55W10pIHtcbiAgaWYgKGxocy5sZW5ndGggIT0gcmhzLmxlbmd0aClcbiAgICByZXR1cm4gZmFsc2VcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGxocy5sZW5ndGg7ICsraSlcbiAgICBpZiAobGhzW2ldICE9IHJoc1tpXSlcbiAgICAgIHJldHVybiBmYWxzZVxuICBcbiAgcmV0dXJuIHRydWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluc2VydEF0PFQ+KGFyeTogcmVhZG9ubHkgVFtdLCBpZHg6IG51bWJlciwgaXRlbTogVCk6IFRbXSB7XG4gIGFzc2VydChpZHggPj0gMCAmJiBpZHggPD0gYXJ5Lmxlbmd0aCwgXCJPT0IgaW5zZXJ0IHRvIGFycmF5XCIsIGFyeS5sZW5ndGgsIGlkeClcbiAgcmV0dXJuIGFyeS5zbGljZSgwLCBpZHgpLmNvbmNhdChpdGVtKS5jb25jYXQoYXJ5LnNsaWNlKGlkeCkpXG59XG5cbi8vIFJlbW92ZSB0aGUgZmlyc3Qgb2NjdXJyYW5jZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudCBmcm9tIHRoZSBhcnJheVxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZShhcnk6IHJlYWRvbmx5IGFueVtdLCBlbDogYW55KSB7XG4gIGNvbnN0IGlkeCA9IGFyeS5pbmRleE9mKGVsKVxuICBhc3NlcnQoaWR4ICE9IC0xLCBcIk9PQiByZW1vdmUgZnJvbSBhcnJheVwiKVxuICByZXR1cm4gYXJ5LnNsaWNlKDAsIGlkeCkuY29uY2F0KGFyeS5zbGljZShpZHgrMSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVJZHg8VD4oYXJ5OiByZWFkb25seSBUW10sIGlkeDogbnVtYmVyKTogVFtdIHtcbiAgYXNzZXJ0KGlkeCAhPSAtMSwgXCJPT0IgcmVtb3ZlIGZyb20gYXJyYXlcIilcbiAgcmV0dXJuIGFyeS5zbGljZSgwLCBpZHgpLmNvbmNhdChhcnkuc2xpY2UoaWR4KzEpKVxufVxuXG5mdW5jdGlvbiBzb3J0X2RlZmF1bHQoYTphbnksIGI6YW55KSB7XG4gIHJldHVybiBhIC0gYlxufVxuXG5leHBvcnQgZnVuY3Rpb24gc29ydGVkPFQ+KGU6IEl0ZXJhYmxlPFQ+LCBzb3J0OiAoYTpULCBiOlQpID0+IG51bWJlciA9IHNvcnRfZGVmYXVsdCk6IFRbXSB7XG4gIHJldHVybiBBcnJheS5mcm9tKGUpLnNvcnQoc29ydClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRlZF9ieTxULCBVPihcbiAgYXJ5OiByZWFkb25seSBUW10sXG4gIHNvcnRfYnk6IChhOlQpID0+IFUsXG4gIHNvcnQ6IChhOlUsIGI6VSkgPT4gbnVtYmVyID0gc29ydF9kZWZhdWx0KTogVFtdIHtcbiAgXG4gIGNvbnN0IHJlc3VsdCA9XG4gICAgYXJ5LlxuICAgIG1hcCgoZWwsaSkgPT4gW3NvcnRfYnkoZWwpLCBpXSBhcyBbVSwgbnVtYmVyXSkuXG4gICAgc29ydCgoYSxiKSA9PiBzb3J0KGFbMF0sIGJbMF0pKVxuICByZXR1cm4gcmVzdWx0Lm1hcCgoXywgaSkgPT4gYXJ5W2ldKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBfYnk8VCxHPihcbiAgYXJ5OiByZWFkb25seSBUW10sXG4gIGdyb3VwOiAoYTpUKSA9PiBHLFxuICBzb3J0OihhOkcsIGI6RykgPT4gbnVtYmVyID0gc29ydF9kZWZhdWx0KTogW0csVFtdXVtdIHtcbiAgXG4gIGlmIChhcnkubGVuZ3RoID09IDApXG4gICAgcmV0dXJuIFtdXG4gIFxuICBjb25zdCByZXN1bHQ6W0csVFtdXVtdID0gW11cbiAgbGV0IHMgPSBzb3J0ZWRfYnkoYXJ5LCBncm91cCwgc29ydClcbiAgXG4gIGNvbnN0IGcgPSBncm91cChzWzBdKVxuICB3aGlsZSAocy5sZW5ndGgpIHtcbiAgICBjb25zdCBhY2N1bSA9IFtdIGFzIFRbXVxuICAgIGZvciAoY29uc3QgZWwgb2Ygcykge1xuICAgICAgY29uc3QgZ18gPSBncm91cChlbClcbiAgICAgIGlmIChzb3J0KGcsIGcpID09IDApIHtcbiAgICAgICAgYWNjdW0ucHVzaChlbClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKFtnLGFjY3VtXSlcbiAgICAgICAgcyA9IHMuc2xpY2UoYWNjdW0ubGVuZ3RoKVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXN0aW5jdDxUPihhcnk6IHJlYWRvbmx5IFRbXSwgc29ydDogKGE6VCwgYjpUKSA9PiBudW1iZXIgPSBzb3J0X2RlZmF1bHQpOiBUW10ge1xuICBpZiAoYXJ5Lmxlbmd0aCA9PSAwKVxuICAgIHJldHVybiBbXVxuICBcbiAgbGV0IHMgPSBzb3J0ZWQoYXJ5LCBzb3J0KVxuXG4gIGNvbnN0IHJlc3VsdCA9IFtzWzBdXVxuICBcbiAgZm9yIChjb25zdCBlbCBvZiBzLnNsaWNlKDEpKSB7XG4gICAgaWYgKHNvcnQoZWwsIHJlc3VsdFtyZXN1bHQubGVuZ3RoLTFdKSAhPSAwKVxuICAgICAgcmVzdWx0LnB1c2goZWwpXG4gIH1cbiAgXG4gIHJldHVybiByZXN1bHRcbn1cblxuLy8gUmV0dXJuIGEgdHVwbGUgb2YgdHdvIGFycmF5cy5cbi8vIFRoZSBmaXJzdCBhcnJheSBjb250YWlucyB0aG9zZSBlbGVtZW50cyB0aGF0IGFyZSBjbGFzc2VkIGFzIGZhbHNlIGJ5IHRoZSBjbGFzc2lmaWVyLlxuZXhwb3J0IGZ1bmN0aW9uIHBhcnRpdGlvbjxUPihhcnk6IHJlYWRvbmx5IFRbXSwgY2xhc3NpZnk6IChhOiBUKSA9PiBib29sZWFuKTogW1RbXSwgVFtdXSB7XG4gIGNvbnN0IGxlZnQ6IFRbXSA9IFtdXG4gIGNvbnN0IHJpZ2h0OiBUW10gPSBbXVxuICBcbiAgZm9yIChjb25zdCBpIG9mIGFyeSkge1xuICAgIGlmIChjbGFzc2lmeShpKSlcbiAgICAgIHJpZ2h0LnB1c2goaSlcbiAgICBlbHNlXG4gICAgICBsZWZ0LnB1c2goaSlcbiAgfVxuICBcbiAgcmV0dXJuIFtsZWZ0LCByaWdodF1cbn1cbiJdfQ==