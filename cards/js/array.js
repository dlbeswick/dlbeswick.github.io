/*
 * Copyright (c) 2021 David Beswick.
 *
 * This file is part of cards-mp
 * (see https://github.com/dlbeswick/cards-mp).
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
import { assert } from './assert.js';
export function range(i) {
    return Array(i).fill(undefined);
}
export function equals(lhs, rhs) {
    if (lhs.length != rhs.length)
        return false;
    for (let i = 0; i < lhs.length; ++i)
        if (lhs[i] != rhs[i])
            return false;
    return true;
}
// Remove the first occurrance of the given element from the array
export function remove(ary, el) {
    const idx = ary.indexOf(el);
    assert(idx != -1, "OOB remove from array");
    return ary.slice(0, idx).concat(ary.slice(idx + 1));
}
function sort_default(a, b) {
    return a - b;
}
export function sorted(e, sort = sort_default) {
    return Array.from(e).sort(sort);
}
export function sorted_by(ary, sort_by, sort = sort_default) {
    const result = ary.
        map((el, i) => [sort_by(el), i]).
        sort((a, b) => sort(a[0], b[0]));
    return result.map((_, i) => ary[i]);
}
export function group_by(ary, group, sort = sort_default) {
    if (ary.length == 0)
        return [];
    const result = [];
    let s = sorted_by(ary, group, sort);
    const g = group(s[0]);
    while (s.length) {
        const accum = [];
        for (const el of s) {
            const g_ = group(el);
            if (sort(g, g) == 0) {
                accum.push(el);
            }
            else {
                result.push([g, accum]);
                s = s.slice(accum.length);
            }
        }
    }
    return result;
}
export function distinct(ary, sort = sort_default) {
    if (ary.length == 0)
        return [];
    let s = sorted(ary, sort);
    const result = [s[0]];
    for (const el of s.slice(1)) {
        if (sort(el, result[result.length - 1]) != 0)
            result.push(el);
    }
    return result;
}
// Return a tuple of two arrays.
// The first array contains those elements that are classed as false by the classifier.
export function partition(ary, classify) {
    const left = [];
    const right = [];
    for (const i of ary) {
        if (classify(i))
            right.push(i);
        else
            left.push(i);
    }
    return [left, right];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJyYXkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi90cy9hcnJheS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBa0JHO0FBQ0gsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGFBQWEsQ0FBQTtBQUVwQyxNQUFNLFVBQVUsS0FBSyxDQUFDLENBQVM7SUFDN0IsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFBO0FBQ2pDLENBQUM7QUFFRCxNQUFNLFVBQVUsTUFBTSxDQUFDLEdBQW1CLEVBQUUsR0FBbUI7SUFDN0QsSUFBSSxHQUFHLENBQUMsTUFBTSxJQUFJLEdBQUcsQ0FBQyxNQUFNO1FBQzFCLE9BQU8sS0FBSyxDQUFBO0lBRWQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDO1FBQ2pDLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDbEIsT0FBTyxLQUFLLENBQUE7SUFFaEIsT0FBTyxJQUFJLENBQUE7QUFDYixDQUFDO0FBRUQsa0VBQWtFO0FBQ2xFLE1BQU0sVUFBVSxNQUFNLENBQUMsR0FBbUIsRUFBRSxFQUFPO0lBQ2pELE1BQU0sR0FBRyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUE7SUFDM0IsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsRUFBRSx1QkFBdUIsQ0FBQyxDQUFBO0lBQzFDLE9BQU8sR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDbkQsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLENBQUssRUFBRSxDQUFLO0lBQ2hD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QUFFLENBQUE7SUFDcEIsTUFBTSxLQUFLLEdBQVEsRUFBRSxDQUFBO0lBRXJCLEtBQUssTUFBTSxDQUFDLElBQUksR0FBRyxFQUFFO1FBQ25CLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQztZQUNiLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7O1lBRWIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtLQUNmO0lBRUQsT0FBTyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtBQUN0QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAoYykgMjAyMSBEYXZpZCBCZXN3aWNrLlxuICpcbiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIGNhcmRzLW1wIFxuICogKHNlZSBodHRwczovL2dpdGh1Yi5jb20vZGxiZXN3aWNrL2NhcmRzLW1wKS5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeVxuICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXNcbiAqIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZVxuICogTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlXG4gKiBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgQWZmZXJvIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG4gKi9cbmltcG9ydCB7IGFzc2VydCB9IGZyb20gJy4vYXNzZXJ0LmpzJ1xuXG5leHBvcnQgZnVuY3Rpb24gcmFuZ2UoaTogbnVtYmVyKSB7XG4gIHJldHVybiBBcnJheShpKS5maWxsKHVuZGVmaW5lZClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVxdWFscyhsaHM6IHJlYWRvbmx5IGFueVtdLCByaHM6IHJlYWRvbmx5IGFueVtdKSB7XG4gIGlmIChsaHMubGVuZ3RoICE9IHJocy5sZW5ndGgpXG4gICAgcmV0dXJuIGZhbHNlXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaHMubGVuZ3RoOyArK2kpXG4gICAgaWYgKGxoc1tpXSAhPSByaHNbaV0pXG4gICAgICByZXR1cm4gZmFsc2VcbiAgXG4gIHJldHVybiB0cnVlXG59XG5cbi8vIFJlbW92ZSB0aGUgZmlyc3Qgb2NjdXJyYW5jZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudCBmcm9tIHRoZSBhcnJheVxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZShhcnk6IHJlYWRvbmx5IGFueVtdLCBlbDogYW55KSB7XG4gIGNvbnN0IGlkeCA9IGFyeS5pbmRleE9mKGVsKVxuICBhc3NlcnQoaWR4ICE9IC0xLCBcIk9PQiByZW1vdmUgZnJvbSBhcnJheVwiKVxuICByZXR1cm4gYXJ5LnNsaWNlKDAsIGlkeCkuY29uY2F0KGFyeS5zbGljZShpZHgrMSkpXG59XG5cbmZ1bmN0aW9uIHNvcnRfZGVmYXVsdChhOmFueSwgYjphbnkpIHtcbiAgcmV0dXJuIGEgLSBiXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzb3J0ZWQ8VD4oZTogSXRlcmFibGU8VD4sIHNvcnQ6IChhOlQsIGI6VCkgPT4gbnVtYmVyID0gc29ydF9kZWZhdWx0KTogVFtdIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oZSkuc29ydChzb3J0KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc29ydGVkX2J5PFQsIFU+KFxuICBhcnk6IHJlYWRvbmx5IFRbXSxcbiAgc29ydF9ieTogKGE6VCkgPT4gVSxcbiAgc29ydDogKGE6VSwgYjpVKSA9PiBudW1iZXIgPSBzb3J0X2RlZmF1bHQpOiBUW10ge1xuICBcbiAgY29uc3QgcmVzdWx0ID1cbiAgICBhcnkuXG4gICAgbWFwKChlbCxpKSA9PiBbc29ydF9ieShlbCksIGldIGFzIFtVLCBudW1iZXJdKS5cbiAgICBzb3J0KChhLGIpID0+IHNvcnQoYVswXSwgYlswXSkpXG4gIHJldHVybiByZXN1bHQubWFwKChfLCBpKSA9PiBhcnlbaV0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBncm91cF9ieTxULEc+KFxuICBhcnk6IHJlYWRvbmx5IFRbXSxcbiAgZ3JvdXA6IChhOlQpID0+IEcsXG4gIHNvcnQ6KGE6RywgYjpHKSA9PiBudW1iZXIgPSBzb3J0X2RlZmF1bHQpOiBbRyxUW11dW10ge1xuICBcbiAgaWYgKGFyeS5sZW5ndGggPT0gMClcbiAgICByZXR1cm4gW11cbiAgXG4gIGNvbnN0IHJlc3VsdDpbRyxUW11dW10gPSBbXVxuICBsZXQgcyA9IHNvcnRlZF9ieShhcnksIGdyb3VwLCBzb3J0KVxuICBcbiAgY29uc3QgZyA9IGdyb3VwKHNbMF0pXG4gIHdoaWxlIChzLmxlbmd0aCkge1xuICAgIGNvbnN0IGFjY3VtID0gW10gYXMgVFtdXG4gICAgZm9yIChjb25zdCBlbCBvZiBzKSB7XG4gICAgICBjb25zdCBnXyA9IGdyb3VwKGVsKVxuICAgICAgaWYgKHNvcnQoZywgZykgPT0gMCkge1xuICAgICAgICBhY2N1bS5wdXNoKGVsKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0LnB1c2goW2csYWNjdW1dKVxuICAgICAgICBzID0gcy5zbGljZShhY2N1bS5sZW5ndGgpXG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RpbmN0PFQ+KGFyeTogcmVhZG9ubHkgVFtdLCBzb3J0OiAoYTpULCBiOlQpID0+IG51bWJlciA9IHNvcnRfZGVmYXVsdCk6IFRbXSB7XG4gIGlmIChhcnkubGVuZ3RoID09IDApXG4gICAgcmV0dXJuIFtdXG4gIFxuICBsZXQgcyA9IHNvcnRlZChhcnksIHNvcnQpXG5cbiAgY29uc3QgcmVzdWx0ID0gW3NbMF1dXG4gIFxuICBmb3IgKGNvbnN0IGVsIG9mIHMuc2xpY2UoMSkpIHtcbiAgICBpZiAoc29ydChlbCwgcmVzdWx0W3Jlc3VsdC5sZW5ndGgtMV0pICE9IDApXG4gICAgICByZXN1bHQucHVzaChlbClcbiAgfVxuICBcbiAgcmV0dXJuIHJlc3VsdFxufVxuXG4vLyBSZXR1cm4gYSB0dXBsZSBvZiB0d28gYXJyYXlzLlxuLy8gVGhlIGZpcnN0IGFycmF5IGNvbnRhaW5zIHRob3NlIGVsZW1lbnRzIHRoYXQgYXJlIGNsYXNzZWQgYXMgZmFsc2UgYnkgdGhlIGNsYXNzaWZpZXIuXG5leHBvcnQgZnVuY3Rpb24gcGFydGl0aW9uPFQ+KGFyeTogcmVhZG9ubHkgVFtdLCBjbGFzc2lmeTogKGE6IFQpID0+IGJvb2xlYW4pOiBbVFtdLCBUW11dIHtcbiAgY29uc3QgbGVmdDogVFtdID0gW11cbiAgY29uc3QgcmlnaHQ6IFRbXSA9IFtdXG4gIFxuICBmb3IgKGNvbnN0IGkgb2YgYXJ5KSB7XG4gICAgaWYgKGNsYXNzaWZ5KGkpKVxuICAgICAgcmlnaHQucHVzaChpKVxuICAgIGVsc2VcbiAgICAgIGxlZnQucHVzaChpKVxuICB9XG4gIFxuICByZXR1cm4gW2xlZnQsIHJpZ2h0XVxufVxuIl19